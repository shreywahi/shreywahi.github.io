const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/driveContentManager-Djd94MFI.js","assets/google-BCF_8OpS.js","assets/index-CgyuYvEv.js","assets/ui-DJraMM9C.js","assets/vendor-CMmhtoO5.js","assets/utils-ZfQrkrhd.js","assets/themes-D6xr4aCK.js","assets/forms-CGX355Lm.js","assets/router-ryKj73NE.js","assets/index-DXxwsh9W.css"])))=>i.map(i=>d[i]);
var e=(e,t,o)=>new Promise(((l,n)=>{var a=e=>{try{r(o.next(e))}catch(t){n(t)}},s=e=>{try{r(o.throw(e))}catch(t){n(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,s);r((o=o.apply(e,t)).next())}));import{d as t,g as o,_ as l,r as n,l as a}from"./index-CgyuYvEv.js";import{r as s,j as r}from"./ui-DJraMM9C.js";import"./vendor-CMmhtoO5.js";import"./utils-ZfQrkrhd.js";import"./themes-D6xr4aCK.js";import"./forms-CGX355Lm.js";import"./router-ryKj73NE.js";const i=({isAdmin:i,reloadFromDrive:d,saveContentToDrive:c,driveSaving:m,driveMessage:u,screenSize:g="desktop"})=>{const[x,h]=s.useState(!1),[b,v]=s.useState([]),[p,w]=s.useState(!1),[f,y]=s.useState((()=>"undefined"!=typeof window&&"true"===localStorage.getItem("useLocalContent")));if(s.useEffect((()=>{const e=t();v(e);const o="true"===localStorage.getItem("useLocalContent");y(o)}),[]),!i)return null;const C=()=>e(null,null,(function*(){w(!0);try{if(d){if(!(yield d()))throw new Error("Failed to reload content")}else yield a(),window.location.reload()}catch(e){alert("Failed to load content from Drive: "+e.message)}finally{w(!1)}})),j=()=>e(null,null,(function*(){try{const{toggleLocalContentMode:t}=yield l((()=>e(null,null,(function*(){const{toggleLocalContentMode:e}=yield import("./driveContentManager-Djd94MFI.js");return{toggleLocalContentMode:e}}))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]));t(!0),y(!0),window.location.reload()}catch(t){alert("Failed to switch to local content: "+t.message)}})),N=()=>e(null,null,(function*(){try{const{toggleLocalContentMode:t}=yield l((()=>e(null,null,(function*(){const{toggleLocalContentMode:e}=yield import("./driveContentManager-Djd94MFI.js");return{toggleLocalContentMode:e}}))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]));t(!1),y(!1),window.location.reload()}catch(t){alert("Failed to switch to Drive content: "+t.message)}})),S=()=>e(null,null,(function*(){try{localStorage.removeItem("cachedContent"),localStorage.removeItem("contentCacheTime"),localStorage.removeItem("useLocalContent");const{resetContentState:t}=yield l((()=>e(null,null,(function*(){const{resetContentState:e}=yield import("./driveContentManager-Djd94MFI.js");return{resetContentState:e}}))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]));t(),yield n(),localStorage.setItem("loadFromDriveOnStart","true"),window.location.reload()}catch(t){localStorage.setItem("loadFromDriveOnStart","true"),window.location.reload()}})),D=o(),L=b.length>0||window.googleCspBlocked;return"mobile"===g||"tablet"===g?r.jsx("div",{className:"fixed top-8 right-4 z-50 pt-4",children:r.jsxs("div",{className:"grid grid-cols-2 gap-2 w-64",children:["          ",f?r.jsx("button",{onClick:N,className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium",children:"Switch to Drive"}):r.jsx("button",{onClick:j,className:"px-2 py-1 bg-orange-600 hover:bg-orange-700 text-white rounded-md text-xs font-medium",children:"Use Local"}),r.jsx("button",{onClick:c,disabled:m||f,className:"px-2 py-1 rounded-md text-xs font-medium "+(m||f?"bg-gray-500 cursor-not-allowed text-gray-300":"bg-purple-600 hover:bg-purple-700 text-white"),title:f?"Cannot save to Drive while in local content mode":"",children:m?"Saving...":"Save to Drive"}),r.jsx("button",{onClick:S,className:"px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium",children:"Reset/Reload"}),r.jsx("button",{onClick:C,disabled:p||f,className:"px-2 py-1 rounded-md text-xs font-medium "+(p||f?"bg-gray-500 cursor-not-allowed text-gray-300":"bg-green-600 hover:bg-green-700 text-white"),title:f?"Cannot load from Drive while in local content mode":"",children:p?"Loading...":"Load from Drive"})]})}):r.jsxs("div",{className:"fixed top-8 right-8 z-50 bg-slate-800 text-white p-4 rounded-lg shadow-lg max-w-md",children:[r.jsx("h3",{className:"text-lg font-bold mb-2",children:"Admin Content Settings"}),u&&r.jsx("div",{className:"mb-4 p-3 rounded-md "+("error"===u.type?"bg-red-900":"success"===u.type?"bg-green-900":"bg-blue-900"),children:r.jsx("p",{className:"text-sm",children:u.text})}),L&&r.jsxs("div",{className:"mb-4 p-3 bg-red-900 rounded-md",children:[r.jsx("p",{className:"text-sm font-semibold mb-1",children:"âš ï¸ CSP Issues Detected"}),r.jsx("p",{className:"text-xs",children:"Google Drive access is blocked by Content Security Policy."}),r.jsx("button",{onClick:()=>h(!x),className:"text-xs underline mt-1",children:x?"Hide Fix":"Show Fix"})]}),x&&r.jsxs("div",{className:"mb-4 p-3 bg-slate-700 rounded-md text-xs",children:[r.jsx("p",{className:"font-semibold mb-2",children:"Add this to your HTML head:"}),r.jsx("textarea",{readOnly:!0,value:D.html,className:"w-full h-32 bg-slate-900 text-white p-2 rounded text-xs font-mono"}),r.jsx("button",{onClick:()=>navigator.clipboard.writeText(D.html),className:"mt-2 px-2 py-1 bg-blue-600 rounded text-xs",children:"Copy to Clipboard"}),"        "]}),"      ",r.jsxs("div",{className:"mb-4 p-3 bg-slate-700 rounded-md",children:[r.jsx("p",{className:"text-sm font-semibold mb-1",children:"ðŸ“‚ Content Source"}),r.jsxs("p",{className:"text-xs",children:["Currently using: ",r.jsx("span",{className:"font-semibold text-yellow-300",children:f?"Local Files (content.json)":"Google Drive (with local fallback)"})]}),r.jsx("p",{className:"text-xs mt-1",children:f?"Content loads from local files. Switch to Drive mode to sync with Google Drive.":"Content loads from Google Drive first, then falls back to local files if Drive is unavailable."})]}),r.jsx("div",{className:"mb-4 flex gap-2",children:f?r.jsx("button",{onClick:N,className:"flex-1 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-sm",children:"Switch to Drive Mode"}):r.jsx("button",{onClick:j,className:"flex-1 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-md text-sm",children:"Use Local Content"})}),r.jsx("button",{onClick:c,disabled:m||f,className:"w-full py-2 rounded-md mb-2 text-white "+(m||f?"bg-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"),title:f?"Cannot save to Drive while in local content mode":"",children:m?"Saving...":"Save to Google Drive"}),r.jsx("button",{onClick:C,disabled:p||f,className:"w-full py-2 rounded-md mb-2 text-white "+(p||f?"bg-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),title:f?"Cannot load from Drive while in local content mode":"",children:p?"Loading from Drive...":"Load Latest from Drive"}),r.jsx("button",{onClick:S,className:"w-full py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md mb-2",children:"Reset Drive Cache & Reload"})]})};export{i as default};
